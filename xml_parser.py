import os
import matplotlib.pyplot as plt

type = os.listdir(r'E:\KU-Android\train\KU-Android-pre-train\folder')

dict = {}
for type_num in range(len(type)):
    folder_path = r'E:\KU-Android\train\KU-Android-pre-train\folder/' + type[type_num]
    folder_list = os.listdir(folder_path)

    error_num = 0
    for folder_num in range(len(folder_list)):
    #for folder_num in range(10):
        try:
            file_name = os.path.join(folder_path, folder_list[folder_num], 'AndroidManifest.xml')
            print(file_name)
            print(folder_num)

            file = open(file_name, 'r', encoding='utf_16_le')

            permision_list = list()
            line = file.readlines()

            txt = ''
            for i in range(len(line)):
                txt += line[i]

            txt = txt.split('.permission.')
            permission = list()
            for i in range(1,len(txt)):
                permission.append(txt[i].split('\x00')[0])

            if type_num is 0:
                for i in range(len(permission)):
                    if permission[i] in dict.keys():
                        value = dict.get(permission[i])
                        #value += 1
                        value[0]+=1
                        dict.update({permission[i]:value})
                    else:
                        #dict_mal.update({permission[i]:1})
                        dict.update({permission[i]: [1, 0]})

            if type_num is 1:
                for i in range(len(permission)):
                    if permission[i] in dict.keys():
                        value = dict.get(permission[i])
                        #value+=1
                        value[1] += 1
                        dict.update({permission[i]:value})
                    else:
                        dict.update({permission[i]:[0,1]})
        except:
            error_num+=1
        print(dict)


dict_list = list(dict.keys())
print(len(dict_list))

x = [i for i in range(len(dict_list))]
y = list()
for i in range(len(dict_list)):
    y.append((dict.get(dict_list[i])[0]))
plt.plot(x, y ,'r')

x = [i for i in range(len(dict_list))]
y = list()
for i in range(len(dict_list)):
    y.append(int((dict.get(dict_list[i])[1])/2))
plt.plot(x, y ,'b')

plt.axis([0,len(dict_list),0,2000])
plt.xlabel('permission')
plt.ylabel('num')
plt.title('num of permission')
plt.show()