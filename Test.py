import numpy as np
import os

from PIL import Image
from os import listdir

from extract_data_sector import extract_data
from extract_data_sector import pixel2img
from extract_data_sector import str2uint8
from extract_data_sector import get_data
from extract_data_sector import pixel2bin_img

option = 0
dex_path = r"E:\KU-Android\train\KU-Android-pre-train\dex"
dex_folder = listdir(dex_path)

section_size = 0x68 #data
section_offset = 0x6c #data
#section_size = 0x60
#section_offset = 0x64

for i in range(len(dex_folder)):
    max = 0
    count = 0
    dex_list = listdir(os.path.join(dex_path, dex_folder[i]))
    for j in range(len(dex_list)):
        f = open(os.path.join(dex_path, dex_folder[i], dex_list[j]), 'rb')

        data_size = extract_data(f, section_size)  # data section의 size를 가져옵니다

        if data_size > max:
            max = data_size
    if i == 0:
        print("malware max = " + str(max) + "pixel resize = " + str(int(max / (224 * 224))))
    else:
        print("normal max = " + str(max) + "pixel resize = " + str(int(max / (224 * 224))))
